---
title: "ConcSession2"
author: "Jason Zhou"
date: "5 July 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

```



```{r}
setwd('C:/Users/jason/Documents/GitHub/sourcemem/EXPIMG/analysis/data/')
dataset <- data.frame()

participants = c("p1","p2","p3","p4","p4","p5","p6","p7","p8","p9","p10","p11","p12","p13","p15","p16","p17","p18","p19","p20") 

for (i in participants){
  participant_dataset <- data.frame()
  for (j in 1:4){
    sessions = c("1","2","3","4")
    s <- j
    this_session_dataset <- read.csv(paste(i,"_",j,".csv",sep=""))
    participant_dataset <- rbind(participant_dataset,this_session_dataset)
    
  }
  participant_dataset$participant <- i
  dataset <- rbind(dataset,participant_dataset) #could have done this with lists, but because its all the same, we are doing it with one big dataset, added a new variable that identifies.
}



#Recoding Low/High
dataset$condition <- relevel(dataset$condition," LOW")
dataset$condition <- as.numeric(factor(dataset$condition))
#dataset$recog_rating <- as.factor(dataset$recog_rating) #Confidence Ratings are Discrete


dataset$response_error <- as.numeric(as.character(dataset$response_error))
dataset.no.na <- dataset[dataset$type!=' FOIL', ]
dataset.na <- dataset[dataset$type==' FOIL', ]

data <- dataset.no.na

data$recog_band <- ifelse(data$recog_rating >= 0 & data$recog_rating <= 3, 'Unrecognized',
                          ifelse(data$recog_rating >=4 & data$recog_rating <=5, 'Low',
                                 ifelse(data$recog_rating ==6, 'High','N/A')
                          )
)

allHist<- ggplot(data = data, aes(x = response_error)) + geom_histogram(bins = 100) + scale_y_continuous(limits=c(0, 700)) + labs(x = "Response Error (radians)", y = "Frequency") + facet_wrap(~ recog_band) + theme_classic() +
  theme(
    strip.text.x = element_text(
      size = 12),
    strip.background = element_rect(
      color= 'white'
    )) +
  theme(axis.text.x = element_text(size = 12, angle = 0, hjust = .5, vjust = .5, face = "plain"),
        axis.text.y = element_text(size = 12, angle = 0, hjust = 1, vjust = 0, face = "plain"),  
        axis.title.x = element_text(size = 12, angle = 0, hjust = .5, vjust = 0, face = "plain"),
        axis.title.y = element_text(size = 12, angle = 90, hjust = .5, vjust = 2, face = "plain"))

    # allHist<- ggplot(data = dataset.no.na, aes(x = dataset.no.na$response_error)) + geom_histogram(bins = 100) + scale_y_continuous(limits=c(0, 700)) + labs(title ="All Recognition Ratings", x = "Response Error (radians)", y = "Frequency") + theme_classic()
    # 
    # unrecogHist<- ggplot(data = unrecog, aes(x = unrecog$response_error)) + geom_histogram(bins = 100) + scale_y_continuous(limits=c(0, 700)) + labs(title ="Unrecognized Items", x = "Response Error (radians)", y = "Frequency") + theme_classic()
    # 
    # 
    # recogHist<- ggplot(data = recog, aes(x = recog$response_error)) + geom_histogram(bins = 100) + scale_y_continuous(limits=c(0, 700)) + labs(title ="Recognized Items", x = "Response Error (radians)", y = "Frequency") + theme_classic()
    # 
    # highHist<- ggplot(data = high, aes(x = high$response_error)) + geom_histogram(bins = 100)+ scale_y_continuous(limits=c(0, 700)) + labs(title ="Highlt Recognized Items", x = "Response Error (radians)", y = "Frequency") + theme_classic()
    
    jumboHist <- ggplot() + geom_histogram(data = dataset.no.na, aes(x = dataset.no.na$response_error, fill="All"), bins = 50) + geom_histogram(data = recog, aes(x = recog$response_error, fill="Recognized"), bins = 50) + geom_histogram(data = unrecog, aes(x = unrecog$response_error, fill="Unrecognized"), bins = 50) + theme_classic()+ labs(x = "Response Error (radians)", y = "Frequency",fill = "Recognition Rating")
    # Write CSV in R
    #write.csv(dataset, file = "dataFiltered3.csv")
    
    ```
    ```{r}
    
    p10_data <- p10_data[(p10_data$recog_rating > 3),]
    p10_data$recog_rating <- as.factor(p10_data$recog_rating)
    
    p10_data$responsebin <- "Fast"
    p10_data[(p10_data$response_RT > 2.3),]$responsebin <- "Slow"
    p10_data$response_error <- as.numeric(as.character(p10_data$response_error))
    
    
    
    cols = c("red","blue","green2","green")
    
    ```
    ```{r}
    plotTheta_RT<- ggplot(data=p10_data,aes(x=response_error)) + geom_histogram(bins = 50, color="black", fill="white") + 
      facet_wrap(~responsebin, labeller = label_wrap_gen(width = 30), ncol = 4) +
      xlab("Response Error") +
      ylab("Count") +
      ggtitle("Response Error by RT Category, Participant 10") +
      theme(
        # x axis label
        # Theme asthetics to make the plot look nicer
        legend.background = element_blank(),
        axis.text.x = element_text(size=10),  # size of text on the x axis
        axis.text.y = element_text(size=10),  # size of text on the y axis
        plot.title = element_text(hjust = 0.5, size = 13),  # title settings (note, centering requires h = 0.5)
        plot.subtitle = element_text(hjust = 0.5, size = 13), # subtitle settiings (note, centering requires h = 0.5)
        plot.caption = element_text(hjust = 0, face = "italic", size = 10), # caption settings
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black")
      )
    
    ```
    
    
    ```{r}
    plotRT_session<- ggplot() + geom_histogram(data=p10_data,aes(x=response_RT, fill = session), color = "black", bins = 50) +  
      facet_wrap(~session, labeller = label_wrap_gen(width = 30), ncol = 4) + 
      xlab("Response Time (seconds)") +
      ylab("Count") +
      ggtitle("Response Time by Session, Participant 10") +
      theme(
        # x axis label
        # Theme asthetics to make the plot look nicer
        legend.background = element_blank(),
        axis.text.x = element_text(size=10),  # size of text on the x axis
        axis.text.y = element_text(size=10),  # size of text on the y axis
        plot.title = element_text(hjust = 0.5, size = 13),  # title settings (note, centering requires h = 0.5)
        plot.subtitle = element_text(hjust = 0.5, size = 13), # subtitle settiings (note, centering requires h = 0.5)
        plot.caption = element_text(hjust = 0, face = "italic", size = 10), # caption settings
        axis.line = element_line(colour = "black")
      )
    
    # Recognition Ratings
    plotRT_conf<- ggplot() + geom_histogram(data=p10_data,aes(x=response_RT, fill = recog_rating), color = "black", bins = 50) +  
      facet_wrap(~recog_rating, labeller = label_wrap_gen(width = 30), ncol = 4) + 
      xlab("Response Time (seconds)") +
      ylab("Count") +
      ggtitle("Response Time by Session, Participant 10") +
      theme(
        # x axis label
        # Theme asthetics to make the plot look nicer
        legend.background = element_blank(),
        axis.text.x = element_text(size=10),  # size of text on the x axis
        axis.text.y = element_text(size=10),  # size of text on the y axis
        plot.title = element_text(hjust = 0.5, size = 13),  # title settings (note, centering requires h = 0.5)
        plot.subtitle = element_text(hjust = 0.5, size = 13), # subtitle settiings (note, centering requires h = 0.5)
        plot.caption = element_text(hjust = 0, face = "italic", size = 10), # caption settings
        axis.line = element_line(colour = "black")
      )
    
    # Response Error bin
    
    
    
    plotRT<- ggplot() + geom_histogram(data=p10_data,aes(x=response_RT), color = "black", fill = "white",bins = 50) +
      xlab("Response Time (seconds)") +
      ylab("Count") +
      ggtitle("Response Time, Participant 10") +
      theme(
        # x axis label
        # Theme asthetics to make the plot look nicer
        legend.background = element_blank(),
        axis.text.x = element_text(size=10),  # size of text on the x axis
        axis.text.y = element_text(size=10),  # size of text on the y axis
        plot.title = element_text(hjust = 0.5, size = 13),  # title settings (note, centering requires h = 0.5)
        plot.subtitle = element_text(hjust = 0.5, size = 13), # subtitle settiings (note, centering requires h = 0.5)
        plot.caption = element_text(hjust = 0, face = "italic", size = 10), # caption settings
        axis.line = element_line(colour = "black")
      )
    ```
    
    ```{r}
    
    
    
    ```