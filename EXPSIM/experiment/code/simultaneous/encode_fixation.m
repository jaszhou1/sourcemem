function [] = encode_fixation(screen, par)
%ENCODE_FIXATION Display a fixation cross for orienting the participant.
%   Display a fixation cross in the encode stage to orient the participant
%   to the centre of the display.
%
% Simon Lilburn <lilburns AT unimelb DOT edu DOT au>

% Make the oval bounding box.
oval_rect = screen.centre_fn(par.circle_radius_px * 2, ... 
    par.circle_radius_px * 2);

% Make fixation cross top, bottom, left, and right.
screen_centre_x = screen.centre(1);
screen_centre_y = screen.centre(2);
fixation_cross_top = screen_centre_y - par.fixation_cross_size_px;
fixation_cross_bottom = screen_centre_y + par.fixation_cross_size_px;
fixation_cross_left = screen_centre_x - par.fixation_cross_size_px;
fixation_cross_right = screen_centre_x + par.fixation_cross_size_px;

% Show the fixation cross and get the initial flip time.
Screen('FrameOval', screen.win, par.inactive_circle_colour, oval_rect, ...
    par.circle_thickness_px);
Screen('DrawLine', screen.win, par.fixation_cross_colour, ...
    fixation_cross_left, screen_centre_y, ...
    fixation_cross_right, screen_centre_y, ...
    par.fixation_cross_width_px);
Screen('DrawLine', screen.win, par.cross_colour, ...
    screen_centre_x, fixation_cross_top, ...
    screen_centre_x, fixation_cross_bottom, ...
    par.fixation_cross_width_px);
trial_start = Screen('Flip', screen.win);

% Show the fixation cross after the appropriate period.
Screen('FrameOval', screen.win, par.inactive_circle_colour, oval_rect, ...
    par.circle_thickness_px);
Screen('DrawLine', screen.win, par.fixation_cross_colour, ...
    fixation_cross_left, screen_centre_y, ...
    fixation_cross_right, screen_centre_y, ...
    par.fixation_cross_width_px);
Screen('DrawLine', screen.win, par.cross_colour, ...
    screen_centre_x, fixation_cross_top, ...
    screen_centre_x, fixation_cross_bottom, ...
    par.fixation_cross_width_px);
Screen('Flip', screen.win, ...
    trial_start + (par.fixation_duration_ms / 1000));

end

